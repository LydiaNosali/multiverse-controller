(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4890ec18"],{"0a0f":function(e,t,a){"use strict";var s=a("57e1"),i=a.n(s);i.a},"0d96":function(e,t,a){"use strict";var s=a("1685"),i=a.n(s);i.a},1685:function(e,t,a){},"27e8":function(e,t,a){},"32ff":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"console"},[a("div",{staticClass:"row row-equal"},[a("div",{staticClass:"flex xs12"},[a("CapabilityTable",{attrs:{capabilities:e.capabilities},on:{"send-spec":e.sendSpecification}})],1)]),a("div",{staticClass:"row row-equal"},[a("div",{staticClass:"flex xs12"},[a("ReceiptTable",{attrs:{receipts:e.receiptsArray},on:{"stop-spec":e.sendInterrupt,"stream-live":e.streamLive}})],1)]),a("RealtimeResults",{attrs:{receipt:e.liveSpec}})],1)},i=[],r=a("a34a"),n=a.n(r),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("va-card",{attrs:{title:e.title}},[a("table",{staticClass:"va-table va-table--striped va-table--hoverable"},[a("thead",[a("tr",e._l(e.headers,(function(t,s){return a("th",{key:s},[e._v(e._s(t))])})),0)]),a("tbody",e._l(e.capabilities,(function(t,s){return a("tr",{key:s},[a("td",[a("va-badge",{attrs:{color:e.getTypeColor(t.data.capability)}},[e._v(" "+e._s(t.data.capability)+" ")]),a("va-badge",{attrs:{color:"primary"}},[e._v(" "+e._s(t.data.name)+" ")])],1),a("td",[a("p",[e._v(" "+e._s(t.data.endpoint+"/"+t.data.schema.slice(0,10))+" ")])]),a("td",[e._v(" "+e._s(t.data.label)+" "),a("br"),e._l(t.data.results,(function(t,s){return a("va-badge",{key:s,attrs:{color:"gray"}},[e._v(" "+e._s(t.split(".")[0])+" ")])}))],2),a("td",[a("va-badge",{attrs:{color:e.getStatusColor(t.status)}},[e._v(" "+e._s(t.status)+" ")])],1),a("td",[a("va-button",{attrs:{small:"",color:"info"},on:{click:function(a){return e.createSpecification(t.data,s)}}},[e._v(" Send specification ")])],1)])})),0)])]),a("va-modal",{attrs:{size:"large",title:e.modalTitle},on:{cancel:e.cancel,ok:e.ok},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"flex md6 sm12 xs12"},[a("label",{staticClass:"label"},[e._v("Temporal scope")]),a("va-input",{attrs:{label:e.$t("forms.selects.multi")},model:{value:e.specification.when.period,callback:function(t){e.$set(e.specification.when,"period",t)},expression:"specification.when.period"}}),a("va-date-picker",{attrs:{label:e.$t("forms.selects.multi"),config:{mode:"range",inline:!0,enableTime:!0}},model:{value:e.specification.when.range,callback:function(t){e.$set(e.specification.when,"range",t)},expression:"specification.when.range"}})],1),a("div",{staticClass:"flex md6 sm12 xs12"},[a("div",{staticClass:"row"},[a("div",{staticClass:"flex md12 sm12 xs12"},[a("label",{staticClass:"label"},[e._v("Results to request")]),a("va-select",{attrs:{label:e.$t("forms.selects.multi"),textBy:"description",multiple:"",options:e.selectedCapability.results},model:{value:e.specification.selectedResults,callback:function(t){e.$set(e.specification,"selectedResults",t)},expression:"specification.selectedResults"}})],1)]),a("div",{staticClass:"flex md12 sm12 xs12"},[a("label",{staticClass:"label"},[e._v("Specification parameters")]),e._l(e.selectedCapability.parameters,(function(t,s){return a("div",{key:s},[a("va-input",{attrs:{label:s},model:{value:e.specification.parameters[s],callback:function(t){e.$set(e.specification.parameters,s,t)},expression:"specification.parameters[nParam]"}})],1)}))],2)])])])],1)},l=[],o={name:"capability",props:["capabilities"],components:{},data:function(){return{headers:["Capability","Name","Available results","Status","Action"],title:"Available capabilities",showModal:!1,modalTitle:"",selectedCapability:{},specification:{selectedResults:[],parameters:{},when:{range:"",period:1e4}}}},created:function(){},methods:{createSpecification:function(e,t){this.selectedCapability=e,this.modalTitle="Create "+e.name+" specification",this.specification.parameters={},this.specification.selectedResults=[];var a=new Date,s=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),i=a.getHours()+":"+a.getMinutes(),r=a.getHours()+1+":"+a.getMinutes(),n=s+" "+i,c=s+" "+r;this.specification.when.range=n+" to "+c,this.showModal=!0},cancel:function(){this.showModal=!1},ok:function(){var e=this.specification.when.range.split(" to "),t=new Date(e[1]),a="now",s="";s=t instanceof Date&&!isNaN(t)?String(t.getTime()):String((new Date).getTime()+6e4);var i=String(this.specification.when.period),r=a+" ... "+s+" / "+i;this.selectedCapability.when=r,this.selectedCapability.parameters=this.specification.parameters,this.specification.selectedResults.length>0&&(this.selectedCapability.results=this.specification.selectedResults),this.$emit("send-spec",this.selectedCapability)},getStatusColor:function(e){return"active"===e?"success":"danger"},getTypeColor:function(e){return"measure"===e?"info":"warning"}}},p=o,d=(a("ad70"),a("2877")),u=Object(d["a"])(p,c,l,!1,null,null,null),f=u.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("va-card",{attrs:{title:e.title}},[e.receipts.length?a("table",{staticClass:"va-table va-table--striped va-table--hoverable"},[a("thead",[a("tr",e._l(e.headers,(function(t,s){return a("th",{key:s},[e._v(e._s(t))])})),0)]),a("tbody",e._l(e.receipts,(function(t){return a("tr",{key:t.schema},[a("td",[e._v(" "+e._s(t.schema.slice(0,10))+" ")]),a("td",[e._v(" "+e._s(t.name)+" ")]),a("td",[e._v(" "+e._s(t.agentId)+" ")]),a("td",[e._v(" "+e._s(t.timestamp)+" ")]),a("td",["measure"===t.receipt?a("va-button",{attrs:{small:"",color:"success"},on:{click:function(a){return e.streamLive(t)}}},[e._v(" Stream live ")]):e._e(),a("va-button",{attrs:{small:"",color:"danger"},on:{click:function(a){return e.stopSpec(t.schema)}}},[e._v(" Stop ")])],1)])})),0)]):e._e()])],1)},v=[],m={name:"receipt",props:["receipts"],data:function(){return{title:"Active specifications",headers:["Schema","Type","Agent","Start time","Action"]}},created:function(){},mounted:function(){},methods:{streamLive:function(e){this.$emit("stream-live",e)},stopSpec:function(e){this.$emit("stop-spec",e)}}},b=m,g=(a("0d96"),Object(d["a"])(b,h,v,!1,null,null,null)),_=g.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("va-modal",{attrs:{size:"large",title:e.title},on:{cancel:e.close,ok:e.close},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",[a("p",[e._v(" Measurement infomation ")]),e.receipt.schema?a("va-badge",{attrs:{color:"info"}},[e._v(" Id: "+e._s(e.receipt.schema)+" ")]):e._e(),e.receipt.agentId?a("va-badge",{attrs:{color:"warning"}},[e._v(" Agent: "+e._s(e.receipt.agentId)+" ")]):e._e(),e.receipt.name?a("va-badge",{attrs:{color:"danger"}},[e._v(" Type: "+e._s(e.receipt.name)+" ")]):e._e(),e.receipt.timestamp?a("va-badge",{attrs:{color:"dark"}},[e._v(" Started at: "+e._s(e.receipt.timestamp)+" ")]):e._e(),a("va-separator"),a("p",[e._v(" Available results ")]),e._l(e.receipt.results,(function(t,s){return a("va-button",{key:s,staticClass:"mr-0",attrs:{small:"",color:"gray"},on:{click:function(t){return e.setTrackedResult(s)}}},[e._v(" "+e._s(t.split(".")[0])+" ")])})),a("va-separator"),1==e.chart?a("va-chart",{staticClass:"chartt",attrs:{data:e.chartData,type:"line"}}):e._e(),2==e.chart?a("va-badge",{attrs:{color:"info"}},[e._v(" "+e._s(e.label)+" ")]):e._e()],2)])},y=[],k={name:"results",props:["receipt"],components:{},data:function(){return{showModal:!1,chart:0,labels:[],label:"",data:[],title:"Live stream results",trackedResultIndex:0}},computed:{chartData:function(){return{labels:this.labels,datasets:[{label:this.label,backgroundColor:"transparent",borderColor:"success",data:this.data}]}}},created:function(){},watch:{receipt:{handler:function(){this.chart=0,this.trackedResultIndex=0,this.labels=[],this.data=[],this.showModal=!0},deep:!0}},methods:{setTrackedResult:function(e){this.chart=0,this.labels=[],this.data=[],this.trackedResultIndex=e},close:function(){this.chart=0,this.trackedResultIndex=0,this.labels=[],this.data=[],this.showModal=!1},getUnitLabel:function(e){switch(e){case"n":return"(#)";case"pc":return"(%)";case"b":return"(Bytes)";default:return""}}},eventbus:{lifecycleHooks:{created:function(e,t){t.registerHandler("nms.info.dss",(function(t,a){if(t)console.log("VertxEventBus error: ",t);else{var s=a.body;if("nms.dss"===s.service){var i=s.content;if(i.schema===e.receipt.schema){var r=i.results[e.trackedResultIndex].split(".");if(r[1]){e.chart=1;var n=r[0],c=r[1];e.labels.push(i.timestamp.split(".")[0]),e.data.push(Number(i.resultValues[0][e.trackedResultIndex])),e.label=n+" "+e.getUnitLabel(c)}else e.chart=2,e.label=r[0]+": "+i.resultValues[0][e.trackedResultIndex]}}}}))}}}},x=k,C=(a("7d9a"),Object(d["a"])(x,w,y,!1,null,"29965dc8",null)),R=C.exports,M={name:"data-streaming",components:{CapabilityTable:f,ReceiptTable:_,RealtimeResults:R},data:function(){return{capabilities:[],receiptsMap:new Map,receiptsArray:[],liveSpec:{}}},created:function(){},methods:{getCapabilities:function(){var e,t;return n.a.async((function(a){while(1)switch(a.prev=a.next){case 0:return e={action:"get_capabilities",params:{}},t=this,a.next=4,n.a.awrap(t.$eventBus.send("nms.dss",e,{},(function(e,a){if(e)console.error("Failed to get capabilities",e);else{var s=a.body;if(s.error)console.log("failed to get capabilities: ",s.error);else{var i=s.content.docs;console.log(i);for(var r=0,n=i.length;r<n;r++){var c="inactive";t.receiptsMap.has(i[r].schema)&&(c="active");var l={data:i[r],status:c};t.capabilities.push(l)}}}})));case 4:case"end":return a.stop()}}),null,this)},getReceipts:function(){var e,t;return n.a.async((function(a){while(1)switch(a.prev=a.next){case 0:return e={action:"get_receipts",params:{}},t=this,a.next=4,n.a.awrap(t.$eventBus.send("nms.dss",e,{},(function(e,a){if(e)console.error("Failed to get receipts",e);else{var s=a.body;if(s.error)console.log("failed to get receipts: ",s.error);else{for(var i=s.content.docs,r=0,n=i.length;r<n;r++)t.receiptsMap.set(i[r].schema,i[r]);t.receiptsArray=i}}})));case 4:case"end":return a.stop()}}),null,this)},updateReceipts:function(){this.receiptsArray=[];var e=this.receiptsMap.values(),t=!0,a=!1,s=void 0;try{for(var i,r=e[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var n=i.value;this.receiptsArray.push(n)}}catch(c){a=!0,s=c}finally{try{t||null==r.return||r.return()}finally{if(a)throw s}}},sendSpecification:function(e){if(this.receiptsMap.has(e.schema))console.log("spec is active");else{var t={action:"send_specification",params:{capability:e}},a=this;this.$eventBus.send("nms.dss",t,{},(function(e,t){if(e)console.error("Failed to send specification",e);else{var s=t.body;if(s.error)return console.log("Failed to send specification: ",s.error),void a.showToast("Failed: cannot get Receipt",{icon:"fa-check",position:"bottom-right",duration:3e3});var i=s.content.receipt;if(0===i.errors.length){a.receiptsMap.set(i.schema,i),a.updateReceipts();for(var r=0,n=a.capabilities.length;r<n;r++)if(a.capabilities[r].data.schema===i.schema){a.capabilities[r].status="active";break}}else a.showToast("Error: "+i.errors[0],{icon:"fa-check",position:"bottom-right",duration:1500})}}))}},sendInterrupt:function(e){var t={action:"send_interrupt",params:{schema:e}},a=this;this.$eventBus.send("nms.dss",t,{},(function(e,t){if(e)console.error("Failed to send interrupt",e);else{var s=t.body;if(s.error)return console.log("error in interrupt processing ",s.error),void a.showToast("error in interrupt processing",{icon:"fa-check",position:"bottom-right",duration:3e3});var i=s.content.schema;a.receiptsMap.delete(i),a.updateReceipts();for(var r=0,n=a.capabilities.length;r<n;r++)if(a.capabilities[r].data.schema===i){a.capabilities[r].status="inactive";break}a.showToast("Specification stopped.",{icon:"fa-check",position:"bottom-right",duration:3e3})}}))},streamLive:function(e){this.liveSpec=e}},eventbus:{lifecycleHooks:{created:function(e,t){return n.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.a.awrap(e.getReceipts());case 2:return t.next=4,n.a.awrap(e.getCapabilities());case 4:case"end":return t.stop()}}))}}}},S=M,T=(a("0a0f"),Object(d["a"])(S,s,i,!1,null,null,null));t["default"]=T.exports},"57e1":function(e,t,a){},"78dc":function(e,t,a){},"7d9a":function(e,t,a){"use strict";var s=a("27e8"),i=a.n(s);i.a},ad70:function(e,t,a){"use strict";var s=a("78dc"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-4890ec18.a286c8a8.js.map